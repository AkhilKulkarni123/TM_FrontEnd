<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Square 4 - Reaction Time Challenge</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            max-width: 650px;
            width: 100%;
        }
        h1 {
            text-align: center;
            color: #fa709a;
            margin-bottom: 10px;
        }
        .instructions {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .stat {
            background: #f0f0f0;
            padding: 10px 20px;
            border-radius: 10px;
        }
        .bullets { color: #ff6b6b; }
        .hits { color: #4ecdc4; }
        .misses { color: #e74c3c; }
        #gameCanvas {
            border: 3px solid #fa709a;
            border-radius: 10px;
            display: block;
            margin: 0 auto;
            background: #fffef0;
            cursor: crosshair;
        }
        .controls {
            text-align: center;
            margin-top: 20px;
        }
        button {
            background: #fa709a;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 5px;
        }
        button:hover {
            background: #fee140;
            color: #333;
            transform: translateY(-2px);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .message {
            text-align: center;
            font-size: 18px;
            margin-top: 20px;
            color: #fa709a;
            font-weight: bold;
            min-height: 30px;
        }
        .countdown {
            text-align: center;
            font-size: 48px;
            font-weight: bold;
            color: #fa709a;
            margin: 20px 0;
            min-height: 60px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>‚ö° Reaction Time Challenge</h1>
        <div class="instructions">
            Click the glowing circles as fast as you can! Get 15 hits before missing 5 times!
        </div>
        
        <div class="countdown" id="countdown"></div>
        
        <div class="game-stats">
            <div class="stat bullets">üí£ Bullets: <span id="bullets">0</span></div>
            <div class="stat hits">üéØ Hits: <span id="hits">0</span>/15</div>
            <div class="stat misses">‚ùå Misses: <span id="misses">0</span>/5</div>
        </div>
        
        <canvas id="gameCanvas" width="580" height="400"></canvas>
        
        <div class="controls">
            <button id="startBtn" onclick="startGame()">Start Game</button>
            <button id="resetBtn" onclick="resetGame()" style="display:none;">Play Again</button>
        </div>
        
        <div id="message" class="message"></div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let gameActive = false;
        let bullets = 0;
        let hits = 0;
        let misses = 0;
        let currentTarget = null;
        let targetTimer;
        let pulseAnimation = 0;
        
        canvas.addEventListener('click', handleClick);
        
        function startGame() {
            document.getElementById('startBtn').disabled = true;
            document.getElementById('message').textContent = '';
            
            // Countdown
            let count = 3;
            document.getElementById('countdown').textContent = count;
            
            const countdownInterval = setInterval(() => {
                count--;
                if (count > 0) {
                    document.getElementById('countdown').textContent = count;
                } else {
                    document.getElementById('countdown').textContent = 'GO!';
                    clearInterval(countdownInterval);
                    setTimeout(() => {
                        document.getElementById('countdown').textContent = '';
                        initGame();
                    }, 500);
                }
            }, 1000);
        }
        
        function initGame() {
            gameActive = true;
            hits = 0;
            misses = 0;
            bullets = 0;
            currentTarget = null;
            
            updateStats();
            spawnTarget();
            animate();
        }
        
        function spawnTarget() {
            if (!gameActive) return;
            
            const radius = 30 + Math.random() * 20;
            const margin = radius + 10;
            
            currentTarget = {
                x: margin + Math.random() * (canvas.width - margin * 2),
                y: margin + Math.random() * (canvas.height - margin * 2),
                radius: radius,
                lifetime: 2000,
                createdAt: Date.now(),
                hue: Math.random() * 360
            };
            
            targetTimer = setTimeout(() => {
                if (gameActive && currentTarget) {
                    misses++;
                    updateStats();
                    
                    if (misses >= 5) {
                        endGame(false);
                    } else {
                        currentTarget = null;
                        setTimeout(spawnTarget, 300);
                    }
                }
            }, currentTarget.lifetime);
        }
        
        function animate() {
            if (!gameActive) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (currentTarget) {
                pulseAnimation += 0.1;
                const elapsed = Date.now() - currentTarget.createdAt;
                const remaining = 1 - (elapsed / currentTarget.lifetime);
                
                // Outer ring (timer indicator)
                ctx.beginPath();
                ctx.arc(currentTarget.x, currentTarget.y, currentTarget.radius + 10, 0, Math.PI * 2);
                ctx.strokeStyle = `hsla(${currentTarget.hue}, 100%, 50%, ${remaining})`;
                ctx.lineWidth = 4;
                ctx.stroke();
                
                // Main target with pulse
                const pulseSize = Math.sin(pulseAnimation) * 3;
                const gradient = ctx.createRadialGradient(
                    currentTarget.x,
                    currentTarget.y,
                    0,
                    currentTarget.x,
                    currentTarget.y,
                    currentTarget.radius + pulseSize
                );
                gradient.addColorStop(0, `hsla(${currentTarget.hue}, 100%, 70%, 0.9)`);
                gradient.addColorStop(0.7, `hsla(${currentTarget.hue}, 100%, 50%, 0.7)`);
                gradient.addColorStop(1, `hsla(${currentTarget.hue}, 100%, 40%, 0.3)`);
                
                ctx.beginPath();
                ctx.arc(currentTarget.x, currentTarget.y, currentTarget.radius + pulseSize, 0, Math.PI * 2);
                ctx.fillStyle = gradient;
                ctx.fill();
                
                // Inner glow
                ctx.beginPath();
                ctx.arc(currentTarget.x, currentTarget.y, currentTarget.radius / 2, 0, Math.PI * 2);
                ctx.fillStyle = `hsla(${currentTarget.hue}, 100%, 90%, 0.8)`;
                ctx.fill();
                
                // Center dot
                ctx.beginPath();
                ctx.arc(currentTarget.x, currentTarget.y, 5, 0, Math.PI * 2);
                ctx.fillStyle = 'white';
                ctx.fill();
            }
            
            requestAnimationFrame(animate);
        }
        
        function handleClick(event) {
            if (!gameActive || !currentTarget) return;
            
            const rect = canvas.getBoundingClientRect();
            const clickX = event.clientX - rect.left;
            const clickY = event.clientY - rect.top;
            
            const distance = Math.sqrt(
                Math.pow(clickX - currentTarget.x, 2) + 
                Math.pow(clickY - currentTarget.y, 2)
            );
            
            if (distance < currentTarget.radius) {
                hits++;
                clearTimeout(targetTimer);
                createHitEffect(currentTarget.x, currentTarget.y, currentTarget.hue);
                updateStats();
                
                if (hits >= 15) {
                    endGame(true);
                } else {
                    currentTarget = null;
                    setTimeout(spawnTarget, 400);
                }
            }
        }
        
        function createHitEffect(x, y, hue) {
            for (let i = 0; i < 12; i++) {
                const angle = (Math.PI * 2 * i) / 12;
                const speed = 3 + Math.random() * 3;
                const particle = {
                    x: x,
                    y: y,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    life: 30,
                    hue: hue,
                    size: 3 + Math.random() * 3
                };
                
                animateParticle(particle);
            }
        }
        
        function animateParticle(particle) {
            let life = particle.life;
            const animate = () => {
                if (life <= 0) return;
                
                particle.x += particle.vx;
                particle.y += particle.vy;
                particle.vx *= 0.95;
                particle.vy *= 0.95;
                life--;
                
                ctx.globalAlpha = life / particle.life;
                ctx.fillStyle = `hsl(${particle.hue}, 100%, 50%)`;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
                
                requestAnimationFrame(animate);
            };
            animate();
        }
        
        function updateStats() {
            document.getElementById('bullets').textContent = bullets;
            document.getElementById('hits').textContent = hits;
            document.getElementById('misses').textContent = misses;
        }
        
        function endGame(won) {
            gameActive = false;
            clearTimeout(targetTimer);
            currentTarget = null;
            
            if (won) {
                bullets = 3;
                document.getElementById('message').textContent = 'üéâ Amazing reflexes! Perfect score! +3 Bullets!';
            } else {
                bullets = Math.floor(hits / 5);
                document.getElementById('message').textContent = `üí• Too many misses! You got ${hits} hits. +${bullets} Bullets!`;
            }
            
            updateStats();
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('resetBtn').style.display = 'inline-block';
        }
        
        function resetGame() {
            document.getElementById('startBtn').disabled = false;
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('resetBtn').style.display = 'none';
            document.getElementById('message').textContent = '';
            document.getElementById('countdown').textContent = '';
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
    </script>
</body>
</html>